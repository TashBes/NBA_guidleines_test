## set the folder path to your newly created project folder Warning! the README.md and any other files with duplicated names will be over-written!
target_path <- "C:\Users\N.Besseling\Documents\repos\NBA_guidleines_test" # I've specified a relative path as all my R projects are in one folder, but it may be easier to use an absolute path copied from your file browser
## set the folder path to your newly created project folder Warning! the README.md and any other files with duplicated names will be over-written!
target_path <- "C:\\Users\\N.Besseling\\Documents\\repos\\NBA_guidleines_test" # I've specified a relative path as all my R projects are in one folder, but it may be easier to use an absolute path copied from your file browser
## create data subfolder
ifelse(!dir.exists(file.path(target_path, "data")), dir.create(file.path(target_path, "data")), FALSE)
## create scripts subfolder
ifelse(!dir.exists(file.path(target_path, "scripts")), dir.create(file.path(target_path, "scripts")), FALSE)
## create outputs subfolder
ifelse(!dir.exists(file.path(target_path, "outputs")), dir.create(file.path(target_path, "outputs")), FALSE)
## copy across the .gitignore; WARNING: this will over-write the .gitignore file in the target_path folder.
file.copy(from = ".gitignore", to = file.path(target_path), overwrite = T)
require(tidyverse)
require(sf)
require(terra)
require(gt)
##load data
dat <- read.csv("RLE20200528_FULLDATASET_for_sharing.csv")
##load data
dat <- read.csv("data/RLE20200528_FULLDATASET_for_sharing.csv")
View(dat)
#####################################################################################
###
ggplot(dat)+
geom_col()+
theme_classic()
#####################################################################################
###
ggplot(dat, aes(dat$NAME, dat$EOO.area.km2.2018))+
geom_col()+
theme_classic()
#####################################################################################
###
ggplot(dat, aes(dat$RLE2020May, dat$EOO.area.km2.2018))+
geom_col()+
theme_classic()
#####################################################################################
###
ggplot(dat, aes(dat$EOO.area.km2.2018, dat$RLE2020May))+
geom_col()+
theme_classic()
#####################################################################################
###
ggplot(dat, aes(dat$EOO.area.km2.2018, dat$RLE2020May))+
geom_col()+
theme_classic()+
scale_color_brewer(palette = 2)
#####################################################################################
###
ggplot(dat, aes(dat$EOO.area.km2.2018, dat$RLE2020May))+
geom_col()+
theme_classic()+
scale_color_brewer(palette = "Green")
#####################################################################################
###
ggplot(dat, aes(dat$EOO.area.km2.2018, dat$RLE2020May))+
geom_col()+
theme_classic()+
scale_color_brewer(type = "qual", palette = "Accent")
bar_plot <- function(DAT, Y, X){
ggplot(DAT, aes(Y, X))+
geom_col()+
theme_classic()+
scale_color_brewer(type = "qual", palette = "Accent")
}
bar_plot(dat, dat$RLE2020May , dat$BIOME)
bar_plot(dat, dat$Nat2018 , dat$BIOME)
bar_plot(dat, dat$Nat2018 , dat$RLE2020May)
bar_plot <- function(DAT, Y, X){
ggplot(DAT, aes(Y, X))+
geom_col()+
theme_classic()+
scale_color_brewer(type = "qual", palette = "Accent")+
labs(x = "test", y = "y test")
}
bar_plot(dat, dat$Nat2018 , dat$RLE2020May)
ggplot(DAT, aes(Y, X))+
geom_col()+
theme_classic()+
scale_color_manual(rainbow())+
labs(x = "test", y = "y test")
bar_plot <- function(DAT, Y, X){
ggplot(DAT, aes(Y, X))+
geom_col()+
theme_classic()+
scale_color_manual(rainbow())+
labs(x = "test", y = "y test")
}
bar_plot(dat, dat$Nat2018 , dat$RLE2020May)
bar_plot <- function(DAT, Y, X){
ggplot(DAT, aes(Y, X))+
geom_col()+
theme_classic()+
labs(x = "test", y = "y test")
}
bar_plot(dat, dat$Nat2018 , dat$RLE2020May)
bar_plot(dat, NAME , dat$CNSRV_TRGT)
bar_plot(dat, dat$NAME , dat$CNSRV_TRGT)
View(dat)
## Purpose of script: To create the  protection level stacked bar diagram for the ecosystem functional groups
##
## Author: Lauryn Bull
##
## Date Created: 2024-04-09
##
## Notes:
##
#####################################################################################
### Load libraries
library(tidyverse)
library(sf)
#####################################################################################
### Load the data
ecoAttr_2023_upd <- read_csv("data/tbl_ecoAttr_2023_updated.csv")
names(ecoAttr_2023_upd)
## subset the data
ecoAttr_2023_sub <- ecoAttr_2023_upd %>%
select(Ecosystem_functional_type, Percent_protected, Threat_status_2023)
## round values in 'percent protected' column to 2 decimal places
ecoAttr_2023_new <- ecoAttr_2023_sub %>% mutate(across(c('Percent_protected'), round, 2))
## order the data from lowest protection to highest threat status levels
ecoAttr_2023_new$Threat_status_2023 <- factor(ecoAttr_2023_new$Threat_status_2023,
levels = c("Least Concern", "Near Threatened",
"Vulnerable", "Endangered", "Critically Endangered"))
## summarise the data
summary_data <- ecoAttr_2023_new %>%
group_by(Ecosystem_functional_type, Threat_status_2023) %>%
summarize(count = n(), ## calculate frequency totals
percent = sum(Percent_protected)) %>% ## calculate the total percentages
mutate(percent = percent / sum(percent) * 100)  ## calculate percentage
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_bw() + ## create a black bounding box around the plot
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(background = element_blank())+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.background = element_blank())+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank())+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = color = "grey")+
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border =  "grey")+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = fill= "grey")+
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= "grey"))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.x = element_line())+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line())+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey"))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey", size = 1))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey", size = 0.1))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey", size = 0.005))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
View(summary_data)
thr_plot <- ggplot(summary_data, aes(y = percent, x = Ecosystem_functional_type, fill = Threat_status_2023)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey", size = 0.005))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
threat_status_plot <-function(DAT, X, Y, FILL )
{
ggplot(DAT, aes(y = Y, x = X, fill = FILL)) +
geom_bar(stat = "identity", width = 0.5) + ## change width of bars
geom_text(aes(label = count), position = position_stack(vjust = 0.5), ## add count labels to the stacked bars and adjust the "vjust" value to place text at the beginning, centre or end of bars
size = 3, color = "black", show.legend = FALSE) + ## adjust size of labels with no legend being shown
scale_fill_manual(values = c("#b1d798", "#eeeea3", "#fff02a", "#f97835", "#e9302c")) +  ## order the colours of the bars in the reversed order
ylab("Percent protected (%)") +
xlab("") + ## remove the heading for the y-axis
guides(fill = guide_legend(reverse = TRUE)) +
labs(fill = "Threat Status") + ## change the legend title here
theme_minimal() + ## create a black bounding box around the plot
theme(panel.grid = element_blank(),
panel.border = element_rect(fill= NA),
panel.grid.major.y = element_line(colour = "grey", size = 0.005))+
theme(legend.position = "bottom") + ## position the legend to beneath the plot
coord_flip()  ## flip the orientation of the chart
thr_plot
}
#####################################################################################
###
threat_status_plot(summary_data, X = ecosystem_function_type, Y = percent)
